<!--
#
#
#  ███████╗ █████╗ ██████╗ ██████╗ ██╗ ██████╗ █████╗     ██████╗ ███████╗
#  ██╔════╝██╔══██╗██╔══██╗██╔══██╗██║██╔════╝██╔══██╗    ██╔══██╗██╔════╝
#  █████╗  ███████║██████╔╝██████╔╝██║██║     ███████║    ██║  ██║█████╗  
#  ██╔══╝  ██╔══██║██╔══██╗██╔══██╗██║██║     ██╔══██║    ██║  ██║██╔══╝  
#  ██║     ██║  ██║██████╔╝██║  ██║██║╚██████╗██║  ██║    ██████╔╝███████╗
#  ╚═╝     ╚═╝  ╚═╝╚═════╝ ╚═╝  ╚═╝╚═╝ ╚═════╝╚═╝  ╚═╝    ╚═════╝ ╚══════╝
#                                                                         
#  ██████╗ ██╗     ██╗   ██╗ ██████╗ ██╗███╗   ██╗███████╗                
#  ██╔══██╗██║     ██║   ██║██╔════╝ ██║████╗  ██║██╔════╝                
#  ██████╔╝██║     ██║   ██║██║  ███╗██║██╔██╗ ██║███████╗                
#  ██╔═══╝ ██║     ██║   ██║██║   ██║██║██║╚██╗██║╚════██║                
#  ██║     ███████╗╚██████╔╝╚██████╔╝██║██║ ╚████║███████║                
#  ╚═╝     ╚══════╝ ╚═════╝  ╚═════╝ ╚═╝╚═╝  ╚═══╝╚══════╝                
#
#
# FABRICA DE PLUGINS
#
# DIOGENES OLIVEIRA DOS SANTOS JUNIOR
# WWW.DIOGENESJUNIOR.COM.BR
# CONTATO@DIOGENESJUNIOR.COM.BR
#
-->
<!DOCTYPE html>
<html lang="pt-br"><head>
<title>PONTO CERTO</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
<meta name="theme-color" content="#000">

<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.css" media="all" />
<link rel="stylesheet" type="text/css" href="assets/css/style.css" />
<link rel="stylesheet" type="text/css" href="assets/css/sweetalert2.min.css">
<!-- ICONES -->
<link rel="stylesheet" href="assets/css/font-awesome.min.css">

<!-- ANIMATE -->
<link rel="stylesheet" type="text/css" href="assets/css/animate.css">
<!-- DROPDOWN -->
<link href="assets/css/bootstrap-dropdownhover.css" rel="stylesheet">

<!-- GOOGLE FONTS -->
<link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;500;700&family=Open+Sans:wght@300;400;700&display=swap" rel="stylesheet">
<!--
  font-family: 'Barlow', sans-serif;
  font-family: 'Open Sans', sans-serif;
-->

<!-- OWL -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
   
</head>
<body>


    <!-- HEADER -->
    <header>
        <div class="row">
          <!-- LOGO -->
          <div class="col-9 logo">
             <a href="javascript:void(0)" title="Logo">
                <img src="assets/images/logo.jpeg" alt="Logo" />
             </a>
          </div>
          <!-- LOGO -->
          <!-- MENU BAR -->
          <div class="col-3 menu-bar-toggle">
             <a href="javascript:void(0)" onclick="app.abrirFecharMenuCliente();" title="Abrir o menu">
               <img src="assets/images/menu-bar.svg" alt="Abrir o menu">
             </a>
          </div>
          <!-- MENU BAR -->
        </div>
    </header>
    <!-- HEADER -->


    <!-- CORPO -->
    <section id="content">
        <p class="text-center">Carregando</p>
    </section>
    <!-- CORPO -->


    <!-- RODAPE / NAVEGACAO -->
    <footer>
        <div class="row">
            <div class="col menu-1">
                <a href="javascript:void(0)" title="Home" onclick="app.viewPrincipalProfissional()">
                    <img src="assets/images/home.svg" alt="Home" />
                    Home
                </a>
            </div>
            <div class="col menu-2">
                <a href="javascript:void(0)" title="Serviços" onclick="app.servicosDesbloqueadosProfissional()">
                    <img src="assets/images/icon.png" alt="Serviços" />
                    Meus Serviços
                </a>
            </div>
            <div class="col menu-3">
                <a href="javascript:void(0)" title="Alertas" onclick="app.alertasProfissionais()">
                    <img src="assets/images/alertas.svg" alt="Alertas" />
                    Alertas
                </a>
            </div>
        </div>
    </footer>
    <!-- RODAPE / NAVEGACAO -->



    <!-- AVISOS -->
    <div class="modal-avisos" id="swipeAviso">
      <div class="aviso">
        <h3></h3>
        <p></p>
      </div>
    </div>
    <!-- AVISOS -->

    <!-- CONFIRMAÇÕES DO USUÁRIO (PROMPT) -->
    <div class="modal-confirmacao" id="swipemeConfirmacao">
      <div class="confirmacao">
        <h3></h3>
        <p id="confirmacaoInstrucao"></p>
        <div class="row">
          
          <div class="col">
            <button type="button" class="btn btn-primary" id="acaoConfirmacao">Confirmar</button>
          </div>
          <div class="col">
             <button type="button" onclick="fecharConfirmacao();" class="btn btn-default">Cancelar</button>
          </div>
          
        </div>
      </div>
    </div>
    <!-- CONFIRMAÇÕES DO USUÁRIO (PROMPT) -->

    <!-- INPUT FLUTUANTE -->
    <div class="input-flutuante-acessibilidade">
      <form id="form-input-flutuante" onsubmit="validarFormularioFlutuante(event)">
          <div class="form-group">
              <label>Nome do campo</label>
              <input type="text" name="fieldInputFlutuante" id="fieldInputFlutuante" class="form-control" placeholder="Digite nesse campo" required />
              <button class="btn btn-default" type="submit">ok</button>
          </div>
      </form>
    </div>
    <!-- INPUT FLUTUANTE -->

    


    <!-- MENU ADICIONAL CLIENTE -->
        <div class="menu-adicional-cliente">
          
              <!-- FECHAR MENU LOJA -->
              <div class="fechar-menu-cliente">
                <a href="javascript:void(0)" title="Fechar menu" onclick="app.abrirFecharMenuCliente();">
                   <img src="assets/images/fechar.svg" alt="Fechar menu">
                </a>
              </div>
              <!-- FECHAR MENU LOJA -->
              
              <!-- NAVEGAÇÃO PRINCIPAL -->
              <nav>
                <ul>

                  <li>
                      <a href="javascript:void(0)" title="Voltar ao início" onclick="app.opcoesCarretamentoPerfilCliente(); app.abrirFecharMenuCliente();">
                        Voltar ao início
                      </a>
                  </li>
                  
                  <li>
                      <a href="javascript:void(0)" title="Meu Perfil" onclick="app.editarPerfil(); app.abrirFecharMenuCliente();">
                        Meu Perfil
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" title="Minhas Solicitações" onclick="app.minhasSolicitacoes(); app.abrirFecharMenuCliente();">
                        Minhas Solicitações
                      </a>
                  </li>

                  
                  <li>
                      <a href="javascript:void(0)" title="Dúvidas e suporte" onclick="app.duvidasESuporte(); app.abrirFecharMenuCliente();">
                        Dúvidas e suporte
                      </a>
                  </li>


                  <li>
                      <a href="javascript:void(0)" title="Trocar tipo de Perfil" onclick="app.abrirFecharMenuCliente(); app.inicio();">
                        Trocar tipo de Perfil
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" title="Configurações" onclick="app.configuracoes(); app.abrirFecharMenuCliente();">
                        Configurações
                      </a>
                  </li>

                  <li>
                    <a href="javascript:void(0)" onclick="app.abrirFecharMenuCliente(); confirmacao('Tem certeza que deseja sair?','Você será deslogado','app.logoff()','Sair')" title="Sair">
                    Sair</a>
                  </li>

                </ul>
              </nav>
              <!-- NAVEGAÇÃO PRINCIPAL -->

        </div>
        <!-- MENU ADICIONAL CLIENTE -->



        <!-- MENU ADICIONAL PROFISSIONAL -->
        <div class="menu-adicional-profissional">
          
              <!-- FECHAR MENU LOJA -->
              <div class="fechar-menu-profissional">
                <a href="javascript:void(0)" title="Fechar menu" onclick="app.abrirFecharMenuProfissional();">
                   <img src="assets/images/fechar.svg" alt="Fechar menu">
                </a>
              </div>
              <!-- FECHAR MENU LOJA -->
              
              <!-- NAVEGAÇÃO PRINCIPAL -->
              <nav>
                <ul>
                  
                  <li>
                      <a href="javascript:void(0)" title="Meu Perfil" onclick="app.editarPerfil(); app.abrirFecharMenuProfissional();">
                        Meu Perfil
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" title="Orçamentos desbloqueados" onclick="app.servicosDesbloqueadosProfissional(); app.abrirFecharMenuProfissional();">
                        Orçamentos desbloqueados
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" onclick="app.cursos(); app.abrirFecharMenuProfissional();" title="Cursos & Treinamentos">
                        Cursos & Treinamentos
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" title="Comprar Chaves" onclick="app.comprarChaves(); app.abrirFecharMenuProfissional();">
                        Comprar Moedas
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" title="Indique e ganhe" onclick="app.indiqueEGanhe(); app.abrirFecharMenuProfissional();">
                        Indique e ganhe
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" title="Dúvidas e suporte" onclick="app.duvidasESuporte(); app.abrirFecharMenuProfissional();">
                        Dúvidas e suporte
                      </a>
                  </li>

                  <li>
                      <a href="javascript:void(0)" title="Trocar tipo de Perfil" onclick="app.abrirFecharMenuProfissional(); app.inicio();">
                        Trocar tipo de Perfil
                      </a>
                  </li>

                  <li>
                    <a href="javascript:void(0)" title="Configurações" onclick="app.configuracoesProfissionais(); app.abrirFecharMenuProfissional();">
                      Configurações
                    </a>
                </li>
                
                  <li>
                    <a href="javascript:void(0)" onclick="app.abrirFecharMenuProfissional(); confirmacao('Tem certeza que deseja sair?','Você será deslogado','app.logoff()','Sair')" title="Sair">
                    Sair</a>
                  </li>

                </ul>
              </nav>
              <!-- NAVEGAÇÃO PRINCIPAL -->

        </div>
        <!-- MENU ADICIONAL PROFISSIONAL -->


        <!-- MODAL CAMERA -->
    <div class="modal-camera" id="swipemeCamera">
      <div class="confirmacao">

        <div id="areaCamera" style="position: relative; width: 100%; height: 300px; background: #666;">

          <button id="trocaCamera" onclick="trocarCamera()">
             <img src="assets/images/8674472_ic_fluent_camera_switch_regular_icon.svg" alt="" />
          </button>

        </div>
        <p>&nbsp;</p>
        
        
        <div class="row">
          <div class="col-12">
            
            <button type="button" onclick="trocarCamera()" class="btn btn-default" style="margin-bottom:12px;">Trocar Camêra</button>
          </div>
          <div class="col-12">
             <button type="button" onclick="desligarCamera();" class="btn btn-default">Cancelar</button>
          </div>
          
        </div>
      </div>
    </div>
    <!-- MODAL CAMERA -->

    <script type="text/javascript" src="assets/js/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

    <script type="text/javascript" src="assets/js/tether.min.js"></script>
    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="assets/js/sweetalert2.min.js"></script>
    <script type="text/javascript" src="assets/js/wow.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery.touchSwipe.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery.form.js"></script>

    <script src="assets/js/dist/jquery.inputmask.bundle.js"></script>
    <script src="assets/js/dist/inputmask/phone-codes/phone.js"></script>

    <script type="text/javascript" src="commom/commom.js"></script> <!-- STANCIAS DE PLUGINS EXTERNOS -->
    <script src="controllers/Controllers.js"></script> <!-- CONTROLLEERS GUARDAM AS FUNCOES GERAIS -->
    <script src="models/Models.js"></script> <!-- MODELOS GUARDAM OS DADOS -->
    <script src="helpers/Helpers.js"></script> <!-- HELPERS GUARDAM FUNCOES DE VALIDACAO OU CONVERSAO -->
    <script src="views/Views.js"></script> <!-- HTML'S -->

    <script type="text/javascript" src="app.js"></script> <!-- SCRIPT GERAL DA APLICACAO -->

    <script>
    
          $("footer").hide();
          $("header .menu-bar-toggle").hide();
          $("#menuProfileToggle").hide();

          setTimeout(function(){ 

              if (window.StatusBar) {
                    // Definir que não sobrepõe o WebView
                    StatusBar.overlaysWebView(false);
                    
                    // Definir cor de fundo (sem #)
                    StatusBar.backgroundColorByHexString('02528d');
                    
                    // Definir estilo do texto (light = texto branco, default = texto preto)
                    StatusBar.styleLightContent(); // Para fundo escuro
                    // ou StatusBar.styleDefault(); // Para fundo claro
                    
                    // Mostrar a status bar
                    StatusBar.show();
                }

          }, 1750);





          function verificarEAtualizarArquivos() {
              console.log('Verificando atualizações...');
              console.log('Versão atual do app:', app.appVersion);
              
              // Primeiro, verificar se já temos uma versão local atualizada
              verificarVersaoLocal()
                  .then(versaoLocal => {
                      console.log('Versão local encontrada:', versaoLocal);
                      
                      // Verificar com servidor
                      consultarServidorAtualizacoes(versaoLocal);
                  })
                  .catch(() => {
                      console.log('Nenhuma versão local encontrada, consultando servidor...');
                      consultarServidorAtualizacoes(null);
                  });
          }

          // Verificar versão local no update.json
          function verificarVersaoLocal() {
              return new Promise((resolve, reject) => {
                  const caminhoJson = cordova.file.dataDirectory + 'update.json';
                  
                  window.resolveLocalFileSystemURL(caminhoJson, 
                      function(fileEntry) {
                          fileEntry.file(function(file) {
                              const reader = new FileReader();
                              reader.onloadend = function() {
                                  try {
                                      const dadosLocal = JSON.parse(this.result);
                                      resolve(dadosLocal.versao || null);
                                  } catch(e) {
                                      reject(new Error('JSON inválido'));
                                  }
                              };
                              reader.readAsText(file);
                          });
                      },
                      function() {
                          reject(new Error('Arquivo não encontrado'));
                      }
                  );
              });
          }

          // Consultar servidor para atualizações
          function consultarServidorAtualizacoes(versaoLocal) {
              let xhr = new XMLHttpRequest();
              xhr.open('POST', app.urlApi + 'verificar-atualizacoes', true);
              xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
              
              var params = 'versao_app=' + app.appVersion + 
                          '&token=' + app.token + 
                          '&plataforma=ANDROID';
              
              xhr.onreadystatechange = () => {
                  if(xhr.readyState == 4) {
                      if(xhr.status == 200) {
                          try {
                              const dados = JSON.parse(xhr.responseText);
                              
                              if (dados.sucesso === "200") {
                                  if (dados.tem_atualizacoes && dados.arquivos.length > 0) {
                                      // Verificar se já temos essa versão
                                      if (versaoLocal === dados.nova_versao) {
                                          console.log('Versão já atualizada localmente, carregando scripts...');
                                          carregarScriptsAtualizados();
                                      } else {
                                          console.log('Nova atualização encontrada:', dados.nova_versao);
                                          mostrarModalConfirmacao(dados);
                                      }
                                  } else {
                                      console.log('App está atualizado!');
                                      carregarScriptsAtualizados(); // Carregar scripts mesmo sem atualizações
                                  }
                              } else {
                                  console.log('Erro ao verificar atualizações:', dados.erro);
                              }
                          } catch (error) {
                              console.error('Erro ao processar resposta:', error);
                          }
                      } else {
                          console.log('Erro na requisição de atualizações. Status:', xhr.status);
                      }
                  }
              };
              
              xhr.send(params);
          }

          // Modal de confirmação estilizado
          function mostrarModalConfirmacao(dados) {
              const modal = document.createElement('div');
              modal.id = 'modal-atualizacao';
              modal.style.cssText = `
                  position: fixed;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  background: rgba(0, 0, 0, 0.5);
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  z-index: 99999;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              `;
              
              modal.innerHTML = `
                  <div style="
                      background: white;
                      border-radius: 12px;
                      padding: 24px;
                      max-width: 400px;
                      margin: 20px;
                      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
                  ">
                      <div style="text-align: center; margin-bottom: 20px;">
                          <div style="
                              width: 48px;
                              height: 48px;
                              background: #3B82F6;
                              border-radius: 50%;
                              display: flex;
                              align-items: center;
                              justify-content: center;
                              margin: 0 auto 16px auto;
                              color: white;
                              font-size: 20px;
                          ">↓</div>
                          <h3 style="margin: 0; color: #1F2937; font-size: 18px; font-weight: 600;">
                              Atualização Disponível
                          </h3>
                      </div>
                      
                      <div style="margin-bottom: 24px; color: #6B7280; text-align: center;">
                          <p style="margin: 0 0 8px 0;">Nova versão: <strong>${dados.nova_versao}</strong></p>
                          <p style="margin: 0;">Encontramos <strong>${dados.arquivos.length}</strong> arquivo(s) para atualizar</p>
                      </div>
                      
                      <div style="display: flex; gap: 12px;">
                          <button onclick="fecharModalAtualizacao()" style="
                              flex: 1;
                              padding: 12px 16px;
                              background: #F3F4F6;
                              color: #374151;
                              border: none;
                              border-radius: 8px;
                              font-weight: 500;
                              cursor: pointer;
                              transition: background-color 0.2s;
                          " onmouseover="this.style.background='#E5E7EB'" onmouseout="this.style.background='#F3F4F6'">
                              Agora não
                          </button>
                          <button onclick="iniciarAtualizacao(${JSON.stringify(dados).replace(/"/g, '&quot;')})" style="
                              flex: 1;
                              padding: 12px 16px;
                              background: #3B82F6;
                              color: white;
                              border: none;
                              border-radius: 8px;
                              font-weight: 500;
                              cursor: pointer;
                              transition: background-color 0.2s;
                          " onmouseover="this.style.background='#2563EB'" onmouseout="this.style.background='#3B82F6'">
                              Atualizar
                          </button>
                      </div>
                  </div>
              `;
              
              document.body.appendChild(modal);
          }

          function fecharModalAtualizacao() {
              const modal = document.getElementById('modal-atualizacao');
              if (modal) {
                  modal.remove();
              }
              // Carregar scripts mesmo se não atualizar
              carregarScriptsAtualizados();
          }

          function iniciarAtualizacao(dados) {
              fecharModalAtualizacao();
              processarAtualizacoes(dados.arquivos, dados.nova_versao);
          }

          // Processar lista de arquivos para atualizar
          function processarAtualizacoes(arquivos, novaVersao) {
              const totalArquivos = arquivos.length;
              
              // Mostrar progresso
              mostrarProgressoAtualizacao(0, totalArquivos);
              
              // Processar arquivos sequencialmente
              processarProximoArquivo(0, arquivos, totalArquivos, 0, 0, novaVersao);
          }

          // Processar arquivo por arquivo
          function processarProximoArquivo(indice, arquivos, totalArquivos, sucessos, erros, novaVersao) {
              if (indice >= arquivos.length) {
                  finalizarAtualizacao(sucessos, erros, novaVersao);
                  return;
              }
              
              const arquivo = arquivos[indice];
              
              baixarArquivo(arquivo.url_remota, arquivo.caminho_local)
                  .then(() => {
                      sucessos++;
                      console.log('Arquivo baixado:', arquivo.nome);
                  })
                  .catch((error) => {
                      erros++;
                      console.error('Erro ao baixar', arquivo.nome, ':', error);
                  })
                  .finally(() => {
                      mostrarProgressoAtualizacao(indice + 1, totalArquivos);
                      processarProximoArquivo(indice + 1, arquivos, totalArquivos, sucessos, erros, novaVersao);
                  });
          }

          // Baixar arquivo individual
          function baixarArquivo(urlRemota, caminhoLocal) {
              return new Promise((resolve, reject) => {
                  if (typeof FileTransfer === 'undefined') {
                      reject(new Error('Plugin FileTransfer não encontrado'));
                      return;
                  }
                  
                  const fileTransfer = new FileTransfer();
                  const caminhoCompleto = cordova.file.dataDirectory + caminhoLocal;
                  
                  console.log('Baixando:', urlRemota, 'para:', caminhoCompleto);
                  
                  fileTransfer.download(urlRemota, caminhoCompleto, resolve, reject);
              });
          }

          // Finalizar processo de atualização
          function finalizarAtualizacao(sucessos, erros, novaVersao) {
              ocultarProgressoAtualizacao();
              
              if (sucessos > 0) {
                  // Salvar versão atualizada no update.json
                  salvarVersaoLocal(novaVersao)
                      .then(() => {
                          app.appVersion = novaVersao;
                          localStorage.setItem('app_version', novaVersao);
                          
                          mostrarModalSucesso(sucessos, erros);
                      })
                      .catch(() => {
                          mostrarModalSucesso(sucessos, erros);
                      });
              } else {
                  mostrarModalErro();
              }
          }

          // Salvar versão no update.json
          function salvarVersaoLocal(versao) {
              return new Promise((resolve, reject) => {
                  const dadosUpdate = {
                      versao: versao,
                      timestamp: new Date().toISOString(),
                      app_version: app.appVersion
                  };
                  
                  window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function(dirEntry) {
                      dirEntry.getFile('update.json', {create: true}, function(fileEntry) {
                          fileEntry.createWriter(function(fileWriter) {
                              fileWriter.onwriteend = resolve;
                              fileWriter.onerror = reject;
                              
                              const blob = new Blob([JSON.stringify(dadosUpdate, null, 2)], {type: 'application/json'});
                              fileWriter.write(blob);
                          });
                      });
                  });
              });
          }

          // Modal de sucesso
          function mostrarModalSucesso(sucessos, erros) {
              const modal = document.createElement('div');
              modal.style.cssText = `
                  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                  background: rgba(0, 0, 0, 0.5); display: flex; align-items: center;
                  justify-content: center; z-index: 99999;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              `;
              
              modal.innerHTML = `
                  <div style="background: white; border-radius: 12px; padding: 24px; max-width: 400px; margin: 20px; text-align: center;">
                      <div style="width: 48px; height: 48px; background: #10B981; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px auto; color: white; font-size: 20px;">✓</div>
                      <h3 style="margin: 0 0 16px 0; color: #1F2937;">Atualização Concluída!</h3>
                      <p style="margin: 0 0 24px 0; color: #6B7280;">✓ ${sucessos} arquivos atualizados${erros > 0 ? `\n✗ ${erros} erros` : ''}</p>
                      <button onclick="window.location.reload()" style="width: 100%; padding: 12px 16px; background: #10B981; color: white; border: none; border-radius: 8px; font-weight: 500; cursor: pointer;">
                          Reiniciar App
                      </button>
                  </div>
              `;
              
              document.body.appendChild(modal);
          }

          // Modal de erro
          function mostrarModalErro() {
              const modal = document.createElement('div');
              modal.style.cssText = `
                  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                  background: rgba(0, 0, 0, 0.5); display: flex; align-items: center;
                  justify-content: center; z-index: 99999;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              `;
              
              modal.innerHTML = `
                  <div style="background: white; border-radius: 12px; padding: 24px; max-width: 400px; margin: 20px; text-align: center;">
                      <div style="width: 48px; height: 48px; background: #EF4444; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px auto; color: white; font-size: 20px;">!</div>
                      <h3 style="margin: 0 0 16px 0; color: #1F2937;">Erro na Atualização</h3>
                      <p style="margin: 0 0 24px 0; color: #6B7280;">Nenhum arquivo foi atualizado com sucesso.</p>
                      <button onclick="this.parentElement.parentElement.remove(); carregarScriptsAtualizados();" style="width: 100%; padding: 12px 16px; background: #6B7280; color: white; border: none; border-radius: 8px; font-weight: 500; cursor: pointer;">
                          Continuar
                      </button>
                  </div>
              `;
              
              document.body.appendChild(modal);
          }

          // Interface de progresso
          function mostrarProgressoAtualizacao(atual, total) {
              const porcentagem = Math.round((atual / total) * 100);
              
              let progressDiv = document.getElementById('progress-atualizacao');
              if (!progressDiv) {
                  progressDiv = document.createElement('div');
                  progressDiv.id = 'progress-atualizacao';
                  progressDiv.style.cssText = `
                      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                      background: white; color: #1F2937; padding: 30px; border-radius: 12px;
                      z-index: 99999; text-align: center; min-width: 300px;
                      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                  `;
                  document.body.appendChild(progressDiv);
              }
              
              progressDiv.innerHTML = `
                  <div style="width: 48px; height: 48px; background: #3B82F6; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px auto; color: white; font-size: 20px;">↓</div>
                  <h4 style="margin: 0 0 15px 0; font-weight: 600;">Atualizando App...</h4>
                  <p style="margin: 0 0 20px 0; color: #6B7280;">Progresso: ${atual}/${total} (${porcentagem}%)</p>
                  <div style="width: 100%; height: 8px; background: #F3F4F6; border-radius: 4px; overflow: hidden;">
                      <div style="width: ${porcentagem}%; height: 100%; background: #3B82F6; transition: width 0.3s; border-radius: 4px;"></div>
                  </div>
                  <p style="margin: 20px 0 0 0; font-size: 12px; color: #9CA3AF;">Por favor, não feche o app</p>
              `;
          }

          function ocultarProgressoAtualizacao() {
              const progressDiv = document.getElementById('progress-atualizacao');
              if (progressDiv) {
                  progressDiv.remove();
              }
          }

          // Carregar arquivos atualizados (scripts.js e atualizacoes.css)
          function carregarScriptsAtualizados() {
              // Carregar CSS primeiro
              carregarCSSAtualizado();
              
              // Depois carregar JavaScript
              const caminhoScript = cordova.file.dataDirectory + 'scripts.js';
              
              window.resolveLocalFileSystemURL(caminhoScript, 
                  function(fileEntry) {
                      console.log('Scripts atualizados encontrados, carregando...');
                      
                      fileEntry.file(function(file) {
                          const reader = new FileReader();
                          reader.onloadend = function() {
                              try {
                                  eval(this.result);
                                  console.log('Scripts atualizados carregados com sucesso!');
                              } catch(e) {
                                  console.error('Erro ao executar scripts atualizados:', e);
                              }
                          };
                          reader.readAsText(file);
                      });
                  }, 
                  function() {
                      console.log('Nenhum script atualizado encontrado');
                  }
              );
          }

          // Carregar CSS atualizado
          function carregarCSSAtualizado() {
              const caminhoCSS = cordova.file.dataDirectory + 'atualizacoes.css';
              
              window.resolveLocalFileSystemURL(caminhoCSS, 
                  function(fileEntry) {
                      console.log('CSS atualizado encontrado, carregando...');
                      
                      fileEntry.file(function(file) {
                          const reader = new FileReader();
                          reader.onloadend = function() {
                              try {
                                  // Remover CSS anterior se existir
                                  const cssAnterior = document.getElementById('css-atualizacoes');
                                  if (cssAnterior) {
                                      cssAnterior.remove();
                                  }
                                  
                                  // Criar novo elemento style
                                  const style = document.createElement('style');
                                  style.id = 'css-atualizacoes';
                                  style.innerHTML = this.result;
                                  document.head.appendChild(style);
                                  
                                  console.log('CSS atualizado carregado com sucesso!');
                              } catch(e) {
                                  console.error('Erro ao carregar CSS atualizado:', e);
                              }
                          };
                          reader.readAsText(file);
                      });
                  }, 
                  function() {
                      console.log('Nenhum CSS atualizado encontrado');
                  }
              );
          }

          // Verificação automática no início do app
          //document.addEventListener('deviceready', function() {
              //setTimeout(verificarEAtualizarArquivos, 3000);
          //});

          // Botão manual (opcional)
          function adicionarBotaoAtualizacao() {
              const botao = document.createElement('button');
              botao.innerHTML = 'Verificar Atualizações';
              botao.onclick = verificarEAtualizarArquivos;
              botao.style.cssText = `
                  position: fixed; bottom: 10px; right: 10px; z-index: 9999;
                  padding: 10px 15px; background: #3B82F6; color: white;
                  border: none; border-radius: 8px; font-size: 12px; cursor: pointer;
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              `;
              document.body.appendChild(botao);
          }

    </script>
    <script data-consolejs-channel="4eb78d5b-5387-1231-567c-f8be08248918" src="https://remotejs.com/agent/agent.js"></script>
    <script src="cordova.js"></script>
    
</body>
</html>
